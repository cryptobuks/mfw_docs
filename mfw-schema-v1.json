{
    "$schema": "http://json-schema.org/draft-06/schema#",
    "description": "schema for the JSON settings",
    "type": "object",
    "required": ["version","system","network"],
    "properties": {
	    "version": {
	        "type": "integer",
	        "minimum": 1
	    },
	    "network": { "$ref": "#/definitions/network_settings" },
	    "system": { "$ref": "#/definitions/system_settings" },
	    "reports": { "$ref": "#/definitions/reports_settings" },
	    "firewall": { "$ref": "#/definitions/firewall_settings" },
	    "dhcp": { "$ref": "#/definitions/dhcp_settings" },
	    "dns": { "$ref": "#/definitions/dns_settings" },
	    "admin": { "$ref": "#/definitions/admin_settings" }
    },
    "definitions": {
	    "admin_settings": {
	        "type": "object",
	        "description": "administration settings",
	        "properties": {
		        "credentials": {
		            "type": "array",
		            "items": { "$ref": "#/definitions/admin_credentials" }
		        }
	        }
	    },
	    "admin_credentials": {
	        "type": "object",
	        "description": "A specific admin user settings",
	        "properties": {
		        "username": {
		            "description": "The username",
		            "type": "string"
		        },
		        "passwordCleartext": {
		            "description": "The cleartext password - this should not be saved in the settings file",
		            "type": "string"
		        }
	        }
	    },
	    "firewall_settings": {
	        "type": "object",
	        "description": "firewall/nftables settings",
	        "properties": {
		        "tables": {
		            "type": "object",
		            "description": "A map from the table name as the key, to the table json object",
		            "patternProperties": {
			            ".{1,}": { "$ref": "#/definitions/table" }
		            }
		        }
	        }
	    },
	    "reports_settings": {
	        "type": "object",
	        "description": "reports settings",
	        "properties": {
		        "entries": {
		            "type": "array",
		            "items": { "$ref": "#/definitions/report_entry" }
		        }
	        }
	    },
        "report_entry": {
	        "type": "object",
	        "description": "A single report",
	        "properties": {
		        "uniqueId": {
		            "type": "string",
		            "description": "The unique string identifier"
		        },
		        "name": {
		            "type": "string",
		            "description": "The name of the report"
		        },
		        "category": {
		            "Type": "string",
		            "description": "The category of the report"
		        },
		        "description": {
		            "Type": "string",
		            "description": "The description of the report"
		        },
		        "displayOrder": {
		            "type": "integer",
		            "description": "The sort order for this report"
		        },
		        "readOnly": {
		            "type": "boolean",
		            "description": "True if read only, False otherwise"
		        },
		        "type": {
		            "type": "string",
		            "enum": ["TEXT","PIE_CHART","TIME_CHART","TIME_DYNAMIC_CHART","EVENT_LIST"]
		        },
                "rendering": {
                    "$ref": "#/definitions/report_rendering"
                }
	        }
        },
        "report_rendering": {
	        "type": "object",
	        "description": "The report render (display) options",
	        "properties": {
                "units": {
		            "type": "string",
		            "description": "The units of the report"
                },
                "colors": {
		            "type": "array",
                    "description": "The color pallette",
		            "items": {"type": "string"}
                },
                "pieNumSlices": {
		            "type": "integer",
		            "description": "The number of pie slices to show on pie charts by default"
                },
                "pieStyle": {
		            "type": "string",
		            "description": "The style of the pie chart",
                    "enum": ["PIE","PIE_3D","DONUT","DONUT_3D","COLUMN","COLUMN_3D"]
                },
                "textString": {
		            "type": "string",
		            "description": "The string to display with the values in a text report"
                },
                "timeStyle": {
		            "type": "string",
		            "description": "The style of the time chart",
                    "enum": ["BAR","BAR_OVERLAPPED","BAR_STACKED","LINE","AREA","AREA_STACKED"]
                },
                "approximation": {
		            "type": "string",
		            "description": "The highchart approximation technique",
                    "enum": ["average", "open", "high", "low", "close", "sum"]
                }
            }            
        },
	    "system_settings": {
	        "type": "object",
	        "description": "system settings",
	        "required": ["hostName","domainName"],
	        "additionalProperties": false,
	        "properties": {
		        "hostName": {"type": "string"},
		        "domainName": {"type": "string"}
	        }
	    },
	    "network_settings": {
	        "type": "object",
	        "description": "network settings",
	        "required": [],
	        "additionalProperties": false,
	        "properties": {
		        "interfaces": {
		            "type": "array",
		            "items": { "$ref": "#/definitions/interface_settings" }
		        },
		        "devices": {
		            "type": "array",
		            "items": { "$ref": "#/definitions/device_settings" }
		        },
		        "switches": {
		            "type": "array",
		            "items": { "$ref": "#/definitions/switch_settings" }
		        }
	        }
	    },
	    "interface_settings": {
	        "type": "object",
	        "description": "interface settings",
	        "required": ["interfaceId","name","device","type","wan","configType"],
	        "additionalProperties": false,
	        "properties": {
		        "interfaceId": {
		            "type": "integer",
		            "description": "Unique interface ID",
		            "minimum": 1
		        },
		        "name": {
		            "type": "string",
		            "description": "Human readable name",
		            "maxLength": 8,
		            "minLength": 1
		        },
		        "device": {
		            "type": "string",
		            "description": "The physical dev represented by this interface (eth0)"
		        },
		        "wan": {
		            "type": "boolean",
		            "description": "True if interface is a WAN (internet) connected interface, False otherwise"
		        },
		        "hidden": {
		            "type": "boolean",
		            "description": "True if this interface should be hidden from the user, False otherwise"
		        },
		        "type": {
		            "type": "string",
		            "enum": ["NIC","VLAN","WIFI","OPENVPN"]
		        },
		        "configType": {
		            "type": "string",
		            "description": "The configuration type",
		            "enum": ["ADDRESSED","BRIDGED","DISABLED"]
		        },
		        "natEgress": {
		            "type": "boolean",
		            "description": "If true, NAT outbound sessions and block non-port-forwarded sessions from this interface"
		        },
		        "natIngress": {
		            "type": "boolean",
		            "description": "If true, NAT inbound sessions and block non-port-forwarded sessions to this interface"
		        },
		        "v4ConfigType": {
		            "type": "string",
		            "description": "The IPv4 configuration type",
		            "enum": ["STATIC","DHCP","DISABLED"]
		        },
		        "v4StaticAddress": {
		            "type": "string",
		            "description": "The IPv4 static address",
		            "format": "ipv4"
		        },
		        "v4StaticPrefix": {
		            "type": "integer",
		            "description": "The IPv4 static prefix (netmask)",
		            "minimum": 1,
		            "maximum": 32
		        },
		        "v4StaticGateway": {
		            "type": "string",
		            "description": "The IPv4 static gateway",
		            "format": "ipv4"
		        },
		        "v4StaticDNS1": {
		            "type": "string",
		            "description": "The IPv4 DNS 1",
		            "format": "ipv4"
		        },
		        "v4StaticDNS2": {
		            "type": "string",
		            "description": "The IPv4 DNS 2",
		            "format": "ipv4"
		        },
		        "v4DhcpAddressOverride": {
		            "type": "string",
		            "description": "The DHCP address override",
		            "format": "ipv4"
		        },
		        "v4DhcpPrefixOverride": {
		            "type": "integer",
		            "description": "The DHCP prefix override",
		            "minimum": 1,
		            "maximum": 32
		        },
		        "v4DhcpGatewayOverride": {
		            "type": "string",
		            "description": "The DHCP gateway override",
		            "format": "ipv4"
		        },
		        "v4DhcpDNS1Override": {
		            "type": "string",
		            "description": "The DHCP DNS 1 override",
		            "format": "ipv4"
		        },
		        "v4DhcpDNS2Override": {
		            "type": "string",
		            "description": "The DHCP DNS 2 override",
		            "format": "ipv4"
		        },
		        "v4PPPoEUsername": {
		            "type": "string",
		            "description": "The PPPoE username",
		            "minLength": 1
		        },
		        "v4PPPoEPassword": {
		            "type": "string",
		            "description": "The PPPoE password",
		            "minLength": 1
		        },
		        "v4PPPoEUsePeerDNS": {
		            "type": "boolean",
		            "description": "If true, use PPPoE peer DNS"
		        },
		        "v4PPPoEOverrideDNS1": {
		            "type": "string",
		            "description": "The PPPoE DNS 1 override",
		            "format": "ipv4"
		        },
		        "v4PPPoEOverrideDNS2": {
		            "type": "string",
		            "description": "The PPPoE DNS 2 override",
		            "format": "ipv4"
		        },
		        "v4Aliases": {
		            "type": "array",
		            "description": "IPv4 address aliases",
		            "items": { "$ref": "#/definitions/ipv4_alias" }
		        },
		        "v6ConfigType": {
		            "type": "string",
		            "description": "IPv6 configuration type",
		            "enum": ["DHCP","SLAAC","ASSIGN","STATIC","DISABLED"]
		        },
		        "v6StaticAddress": {
		            "type": "string",
		            "description": "The IPv6 static address",
		            "format": "ipv6"
		        },
		        "v6StaticPrefix": {
		            "type": "integer",
		            "description": "The IPv6 static prefix",
		            "minimum": 1,
		            "maximum": 128
		        },
		        "v6StaticGateway": {
		            "type": "string",
		            "description": "The IPv6 static gateway",
		            "format": "ipv6"
		        },
		        "v6StaticDNS1": {
		            "type": "string",
		            "description": "The IPv6 DNS 1",
		            "format": "ipv6"
		        },
		        "v6StaticDNS2": {
		            "type": "string",
		            "description": "The IPv6 DNS 2",
		            "format": "ipv6"
		        },
		        "v6AssignHint": {
		            "type": "string",
		            "description": "The IPv6 auto assign hint"
		        },
		        "v6AssignPrefix": {
		            "type": "integer",
		            "description": "The IPv6 auto assign prefix",
		            "minimum": 1,
		            "maximum": 128
		        },
		        "v6Aliases": {
		            "type": "array",
		            "description": "IPv6 address aliases",
		            "items": { "$ref": "#/definitions/ipv6_alias" }
		        },
		        "routerAdvertisements": {
		            "type": "boolean",
		            "description": "Send router advertisements"
		        },
		        "downloadKbps": {
		            "type": "integer",
		            "description": "The maximum download kilobit per second of this WAN interface",
		            "minimum": 0
		        },
		        "uploadKbps": {
		            "type": "integer",
		            "description": "The maximum upload kilobit per second of this WAN interface",
		            "minimum": 0
		        },
		        "dhcpEnabled": {
		            "type": "boolean",
		            "description": "If true, provide DHCP on this interface"
		        },
		        "dhcpRangeStart": {
		            "type": "string",
		            "description": "The start of the DHCP offer range",
		            "format": "ipv4"
		        },
		        "dhcpRangeEnd": {
		            "type": "string",
		            "description": "The end of the DHCP offer range",
		            "format": "ipv4"
		        },
		        "dhcpLeaseDuration": {
		            "type": "integer",
		            "description": "The DHCP lease duration in seconds",
		            "minimum": 0
		        },
		        "dhcpGatewayOverride": {
		            "type": "string",
		            "description": "The DHCP gateway to offer. If null, the local interface IP is used",
		            "format": "ipv4"
		        },
		        "dhcpPrefixOverride": {
		            "type": "integer",
		            "description": "The DHCP prefix/netmask to offer. If null, the local interface prefix is used",
		            "minimum": 1,
		            "maximum": 32
		        },
		        "dhcpDNSOverride": {
		            "type": "string",
		            "description": "The DHCP DNS to offer. If null, the local interface IP is used",
		            "format": "ipv4"
		        },
		        "dhcpOptions": {
		            "type": "array",
		            "description": "DHCP Options",
		            "items": {
			            "type": "object",
			            "description": "A DHCP option",
			            "required": ["enabled","value"],
			            "additionalProperties": false,
			            "properties": {
			                "enabled": {
				                "type": "boolean",
				                "description": "True if option is enabled"
			                },
			                "description": {
				                "type": "string",
				                "description": "Admin-supplied human readable description"
			                },
			                "value": {
				                "type": "string",
				                "description": "The dnsmasq option value"
			                }
			            }
		            }
		        },
		        "vrrpEnabled": {
		            "type": "boolean",
		            "description": "True if VRRP is enabled"
		        },
		        "vrrpID": {
		            "type": "integer",
		            "description": "The VRRP ID",
		            "minimum": 1,
		            "maximum": 255
		        },
		        "vrrpPriority": {
		            "type": "integer",
		            "description": "The VRRP priority",
		            "minimum": 1,
		            "maximum": 255
		        },
		        "vrrpV4Aliases": {
		            "type": "array",
		            "description": "VRRP IPv4 address aliases",
		            "items": { "$ref": "#/definitions/ipv4_alias" }
		        },
		        "wirelessSsid": {
		            "type": "string",
		            "description": "The wireless SSID"
		        },
		        "wirelessEncryption": {
		            "type": "string",
		            "description": "The wireless encryption method",
		            "enum": ["NONE", "WPA1", "WPA12", "WPA2"]
		        },
		        "wirelessMode": {
		            "type": "string",
		            "description": "The wireless mode (AP or client)",
		            "enum": ["AP", "CLIENT"]
		        },
		        "wirelessPassword": {
		            "type": "string",
		            "description": "The wireless password"
		        },
		        "wirelessChannel": {
		            "type": "integer",
		            "description": "The wireless channel",
		            "minimum": 0
		        }
	        }
	    },
	    "device_settings": {
	        "type": "object",
	        "description": "device (NIC) settings",
	        "required": [],
	        "additionalProperties": false,
	        "properties": {
		        "name": {
		            "type": "string",
		            "description": "The device name (eth0)"
		        },
		        "duplex": {
		            "type": "string",
		            "description": "The device duplex setting",
		            "enum": ["AUTO",
			                 "10000_FULL_DUPLEX","10000_HALF_DUPLEX",
			                 "1000_FULL_DUPLEX", "1000_HALF_DUPLEX",
			                 "100_FULL_DUPLEX", "100_HALF_DUPLEX",
			                 "10_FULL_DUPLEX", "10_HALF_DUPLEX"]
		        },
		        "mtu": {
		            "type": ["integer","null"],
		            "description": "The MTU of the device, 0 means auto, null means auto",
		            "minimum": 0
		        }
	        }
	    },
	    "ipv4_alias": {
	        "type": "object",
	        "description": "An IPv4 alias",
	        "required": ["v4Address","v4Prefix"],
	        "v4Address": {
		        "type": "string",
		        "description": "The IPv4 static address",
		        "format": "ipv4"
	        },
	        "v4Prefix": {
		        "type": "integer",
		        "description": "The IPv4 static prefix (netmask)",
		        "minimum": 1,
		        "maximum": 32
	        }
	    },
	    "ipv6_alias": {
	        "type": "object",
	        "description": "An IPv6 alias",
	        "required": ["v6Address","v6Prefix"],
	        "additionalProperties": false,
	        "properties": {
		        "v6Address": {
		            "type": "string",
		            "description": "The IPv6 static address",
		            "format": "ipv6"
		        },
		        "v6Prefix": {
		            "type": "integer",
		            "description": "The IPv6 static prefix",
		            "minimum": 1,
		            "maximum": 128
		        }
	        }
	    },
	    "table": {
	        "type": "object",
	        "required": ["name","family","chains"],
	        "properties": {
		        "name": {
		            "type": "string",
		            "description": "The name of the table"
		        },
		        "family": {
		            "type": "string",
		            "description": "The family of the table",
		            "enum": ["inet","ip","ip6","arp","bridge","netdev","ip,ip6","ip,ip6,inet"]
		        },
		        "chains": {
		            "type": "array",
		            "items": { "$ref": "#/definitions/chain" }
		        },
		        "description": {
		            "type": "string",
		            "description": "The human description"
		        }
	        }
	    },
	    "chain": {
	        "type": "object",
	        "required": ["name","rules"],
	        "properties": {
		        "name": {
		            "type": "string",
		            "description": "The name of the chain"
		        },
		        "description": {
		            "type": "string",
		            "description": "The human description"
		        },
		        "type": {
		            "type": "string",
		            "description": "The type of chain, only applies to base chains",
		            "enum": ["filter","route","nat"]
		        },
		        "hook": {
		            "type": "string",
		            "description": "The netfilter hook, only applies to base chains",
		            "enum": ["prerouting","input","forward","output","postrouting","ingress"]
		        },
		        "priority": {
		            "type": "integer",
		            "description": "The netfilter priority, only applies to base chains"
		        },
		        "base": {
		            "type": "boolean",
		            "description": "True if base chain, False otherwise"
		        },
		        "default": {
		            "type": "boolean",
		            "description": "True if this chain should be the default displayed chain when editing a table"
		        },
		        "editable": {
		            "type": "boolean",
		            "description": "True if chain is editable, False otherwise"
		        },
		        "rules": {
		            "items": { "$ref": "#/definitions/rule" }
		        }
	        }
	    },
	    "rule": {
	        "type": "object",
	        "description": "A rule",
	        "required": ["ruleId"],
	        "additionalProperties": false,
	        "properties": {
		        "ruleId": {
		            "type": "integer",
		            "description": "The rule ID",
		            "minimum": 1
		        },
		        "enabled": {
		            "type": "boolean",
		            "description": "True if rule is enabled, False otherwise"
		        },
		        "description": {
		            "type": "string",
		            "description": "The human description"
		        },
		        "conditions": {
		            "type": "array",
		            "items": { "$ref": "#/definitions/rule_condition" }
		        },
		        "action": { "$ref": "#/definitions/rule_action" }
	        }
	    },
	    "rule_condition": {
	        "type": "object",
	        "description": "A rule condition",
	        "required": ["type","value"],
	        "additionalProperties": false,
	        "properties": {
		        "type": {
		            "type": "string",
		            "enum": ["IP_PROTOCOL",
			                 "SOURCE_ADDRESS",
			                 "DESTINATION_ADDRESS",
			                 "CLIENT_ADDRESS",
			                 "SERVER_ADDRESS",
			                 "LOCAL_ADDRESS",
			                 "REMOTE_ADDRESS",
			                 "CLIENT_ADDRESS_V6",
			                 "SERVER_ADDRESS_V6",
			                 "LOCAL_ADDRESS_V6",
			                 "REMOTE_ADDRESS_V6",
			                 "SOURCE_ADDRESS_V6",
			                 "DESTINATION_ADDRESS_V6",
			                 "SOURCE_PORT",
			                 "DESTINATION_PORT",
			                 "CLIENT_PORT",
			                 "SERVER_PORT",
			                 "LOCAL_PORT",
			                 "REMOTE_PORT",
			                 "CLIENT_INTERFACE_ZONE",
			                 "SERVER_INTERFACE_ZONE",
			                 "SOURCE_INTERFACE_ZONE",
			                 "DESTINATION_INTERFACE_ZONE",
			                 "SOURCE_INTERFACE_NAME",
			                 "DESTINATION_INTERFACE_NAME",
			                 "CLIENT_HOSTNAME",
			                 "SERVER_HOSTNAME",
			                 "LOCAL_HOSTNAME",
			                 "REMOTE_HOSTNAME",
			                 "CLIENT_USERNAME",
			                 "SERVER_USERNAME",
			                 "LOCAL_USERNAME",
			                 "REMOTE_USERNAME",
			                 "CT_STATE",
			                 "LIMIT_RATE"
			                ]
		        },
		        "value": {
		            "type": "string"
		        },
		        "op": {
		            "type": "string",
		            "enum": ["==","!=","<",">","<=",">="]
		        },
			"rate_unit": {
			    "type": "string",
			    "enum": ["PACKETS_PER_SECOND","PACKETS_PER_MINUTE","PACKETS_PER_HOUR","PACKETS_PER_DAY","PACKETS_PER_WEEK","BYTES_PER_SECOND","KBYTES_PER_SECOND","MBYTES_PER_SECOND"]
			},
			"group_selector": {
			    "type": "string",
		            "enum": ["IP_PROTOCOL",
			                 "SOURCE_ADDRESS",
			                 "DESTINATION_ADDRESS",
			                 "SOURCE_ADDRESS_V6",
			                 "DESTINATION_ADDRESS_V6",
			                 "SOURCE_PORT",
			                 "DESTINATION_PORT"
			                ]
			}
	        }
	    },
	    "rule_action": {
	        "type": "object",
	        "description": "A rule condition",
	        "additionalProperties": true,
	        "properties": {
		        "type": {
		            "type": "string",
		            "enum": ["JUMP","GOTO","ACCEPT","REJECT","DROP","DNAT","SNAT","MASQUERADE","SET_PRIORITY"]
		        },
		        "chain": {
		            "type": "string"
		        },
		        "dnat_address": {
		            "type": "string"
		        },
		        "dnat_port": {
		            "type": "integer"
		        },
		        "snat_address": {
		            "type": "string"
		        },
		        "priority": {
		            "type": "integer"
		        }
	        }
	    },
	    "switch_settings": {
	        "type": "object",
	        "description": "Ethernet switch settings",
	        "required": ["name", "ports", "vlans"],
	        "additionalProperties": false,
	        "properties": {
		        "name": {
		            "type": "string",
		            "description": "The switch name (switch0)"
		        },
		        "ports": {
		            "type": "array",
		            "description": "The ports of the switch",
		            "items": { "$ref": "#/definitions/switch_port" }
		        },
		        "vlans": {
		            "type": "array",
		            "description": "The vlans of the switch",
		            "items": { "$ref": "#/definitions/switch_vlan" }
		        }
	        }
	    },
	    "switch_port": {
	        "type": "object",
	        "description": "A port on an Ethernet switch",
	        "required": ["id", "pvid", "cpu_port"],
	        "properties": {
		        "id": {
		            "type": "string",
		            "description": "The port id"
		        },
		        "pvid": {
		            "type": "string",
		            "description": "The primary vlan id"
		        },
		        "cpu_port": {
		            "type": "boolean",
		            "description": "True if this port is connected directly to the CPU"
		        }
	        }
	    },
	    "switch_vlan": {
	        "type": "object",
	        "description": "A vlan on an Ethernet switch",
	        "required": ["id"],
	        "properties": {
		        "id": {
		            "type": "string",
		            "description": "The vlan id"
		        }
	        }
	    },
	    "dhcp_settings": {
	        "type": "object",
	        "description": "DHCP settings",
	        "required": [],
	        "additionalProperties": false,
	        "properties": {
		        "dhcpAuthoritative": {
		            "type": "boolean",
		            "description": "True if this is the only dhcp server on the network"
		        },
		        "staticDhcpEntries": {
		            "type": "array",
		            "description": "List of static DHCP assignements",
		            "items": { "$ref": "#/definitions/static_dhcp_entry" }
		        }
	        }
	    },
	    "static_dhcp_entry": {
	        "type": "object",
	        "description": "An IP address to be statically assinged to a specific device",
	        "required": ["address", "macAddress"],
	        "properties": {
		        "address": {
		            "type": "string",
		            "description": "IP Address to assign to the device"
		        },
		        "macAddress": {
		            "type": "string",
		            "description": "The MAC address of the device"
		        }
	        }
	    },
	    "dns_settings": {
	        "type": "object",
	        "description": "DNS settings",
	        "required": [],
	        "additionalProperties": false,
	        "properties": {
		        "localServers": {
		            "type": "array",
		            "description": "List of local DNS servers",
		            "items": { "$ref": "#/definitions/local_dns_server" }
		        },
		        "staticEntries": {
		            "type": "array",
		            "description": "List of static DNS assignements",
		            "items": { "$ref": "#/definitions/static_dns_entry" }
		        }
	        }
	    },
	    "local_dns_server": {
	        "type": "object",
	        "description": "A local DNS server",
	        "required": ["domain", "localServer"],
	        "properties": {
		        "domain": {
		            "type": "string",
		            "description": "A local domain"
		        },
		        "localServer": {
		            "type": "string",
		            "description": "The IP of a local DNS server"
		        }
	        }
	    },
	    "static_dns_entry": {
	        "type": "object",
	        "description": "A name to map to a specified IP address",
	        "required": ["address", "name"],
	        "properties": {
		        "address": {
		            "type": "string",
		            "description": "IP Address to map"
		        },
		        "name": {
		            "type": "string",
		            "description": "The name to map"
		        }
	        }
	    }
    }
}
